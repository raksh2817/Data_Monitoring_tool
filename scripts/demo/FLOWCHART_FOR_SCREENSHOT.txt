

═══════════════════════════════════════════════════════════════════════════════════════════
                         DATA MONITORING TOOL - PART 1 ARCHITECTURE
═══════════════════════════════════════════════════════════════════════════════════════════


                                      ┌─────────────┐
                                      │   START     │
                                      └──────┬──────┘
                                             │
        ┌────────────────────────────────────┼────────────────────────────────────┐
        │                                    │                                    │
        ▼                                    ▼                                    ▼
┌──────────────────┐              ┌──────────────────┐              ┌──────────────────┐
│  AGENT 1         │              │  AGENT 2         │              │  AGENT 3         │
│  web-server-01   │              │  api-server-02   │              │  db-server-03    │
│                  │              │                  │              │                  │
│  • Collect CPU   │              │  • Collect CPU   │              │  • Collect CPU   │
│  • Collect Memory│              │  • Collect Memory│              │  • Collect Memory│
│  • Collect Disk  │              │  • Collect Disk  │              │  • Collect Disk  │
│                  │              │                  │              │                  │
│  agent.py        │              │  agent.py        │              │  agent.py        │
│  (cron: */1 min) │              │  (cron: */1 min) │              │  (cron: */1 min) │
└────────┬─────────┘              └────────┬─────────┘              └────────┬─────────┘
         │                                 │                                 │
         │  HTTP POST /report              │                                 │
         │  Authorization: Bearer key      │                                 │
         │  JSON: {cpu, mem, disk}         │                                 │
         └─────────────────────────────────┴─────────────────────────────────┘
                                           │
                                           ▼
                           ┌───────────────────────────────────┐
                           │   FLASK REST API SERVER           │
                           │   app.py (Port 5000)              │
                           │                                   │
                           │   Endpoints:                      │
                           │   • POST /report                  │
                           │   • GET  /health                  │
                           └─────────────┬─────────────────────┘
                                         │
                                         ▼
                              ┌──────────────────┐
                              │ Validate host_key│
                              │ Validate JSON    │
                              └─────────┬────────┘
                                        │
                        ┌───────────────┼───────────────┐
                        │ Valid?        │           NO  │
                        │ YES           │               │
                        ▼               │               ▼
                 ┌──────────────┐      │      ┌──────────────┐
                 │ INSERT INTO  │      │      │ Return 403   │
                 │ incoming_data│      │      │ Forbidden    │
                 │              │      │      └──────────────┘
                 │ UPDATE       │      │
                 │ last_seen    │      │
                 └──────┬───────┘      │
                        │              │
                        ▼              │
                 ┌──────────────┐      │
                 │ Return 200 OK│      │
                 └──────┬───────┘      │
                        │              │
                        └──────────────┘
                                │
                                ▼
                 ┌──────────────────────────────────────┐
                 │       MYSQL DATABASE                 │
                 │   mysql.clarksonmsda.org             │
                 │                                      │
                 │   Tables:                            │
                 │   • hosts                            │
                 │   • incoming_data (time-series)      │
                 │   • alert_types                      │
                 │   • alerts                           │
                 │   • host_alert_checks                │
                 └──────────────┬───────────────────────┘
                                │
                                │  Periodic check
                                │  Cron: */2 minutes
                                │
                                ▼
                 ┌──────────────────────────────────────┐
                 │    ALERT CHECKER                     │
                 │    check_alerts.py                   │
                 │                                      │
                 │  1. Get latest metrics               │
                 │  2. Get alert configs                │
                 │  3. Evaluate thresholds              │
                 └──────────────┬───────────────────────┘
                                │
                                ▼
                       ┌────────────────┐
                       │ Threshold      │
                       │ exceeded?      │
                       └────┬───────────┘
                            │
              ┌─────────────┼─────────────┐
              │ NO          │         YES │
              ▼             │             ▼
       ┌─────────────┐     │      ┌─────────────┐
       │ Current:    │     │      │ Current:    │
       │ NORMAL      │     │      │ ALERT       │
       └──────┬──────┘     │      └──────┬──────┘
              │            │             │
              └────────────┴─────────────┘
                           │
                           ▼
                  ┌────────────────┐
                  │ Get previous   │
                  │ alert state    │
                  └────────┬───────┘
                           │
                           ▼
                  ┌────────────────┐
                  │ STATE CHANGE?  │
                  └────┬───────────┘
                       │
       ┌───────────────┼───────────────┐
       │               │               │
       ▼               ▼               ▼
┌──────────────┐ ┌──────────────┐ ┌──────────────┐
│ Normal→Alert │ │ Alert→Normal │ │  No Change   │
│              │ │              │ │              │
│ CREATE ALERT │ │ RESOLVE ALERT│ │  No Action   │
│              │ │              │ │              │
│ 🚨 NEW ALERT │ │ ✅ RESOLVED  │ │ ⚠️ ONGOING   │
└──────┬───────┘ └──────┬───────┘ └──────┬───────┘
       │                │                │
       └────────────────┴────────────────┘
                        │
                        ▼
                   ┌─────────┐
                   │   END   │
                   └─────────┘


═══════════════════════════════════════════════════════════════════════════════════════════
                                    KEY FEATURES
═══════════════════════════════════════════════════════════════════════════════════════════

  ┌─────────────────────────────────────────────────────────────────────────────────────┐
  │  1. REST API ARCHITECTURE                                                           │
  │     • Industry standard (Nagios, Prometheus)                                        │
  │     • Scalable & Secure                                                             │
  └─────────────────────────────────────────────────────────────────────────────────────┘

  ┌─────────────────────────────────────────────────────────────────────────────────────┐
  │  2. AUTHENTICATION                                                                  │
  │     • Unique host_key per server                                                    │
  │     • Bearer token authorization                                                    │
  └─────────────────────────────────────────────────────────────────────────────────────┘

  ┌─────────────────────────────────────────────────────────────────────────────────────┐
  │  3. STATE-CHANGE DETECTION (Innovation!)                                            │
  │     • Only alerts on transitions (Normal ↔ Alert)                                   │
  │     • Prevents alert spam                                                           │
  │     • Example: Disk at 92% for 1 hour = 1 alert (not 30!)                         │
  └─────────────────────────────────────────────────────────────────────────────────────┘

  ┌─────────────────────────────────────────────────────────────────────────────────────┐
  │  4. FLEXIBLE THRESHOLDS                                                             │
  │     • Different thresholds per host                                                 │
  │     • Storage: 95%, Web: 85%                                                        │
  └─────────────────────────────────────────────────────────────────────────────────────┘


═══════════════════════════════════════════════════════════════════════════════════════════
